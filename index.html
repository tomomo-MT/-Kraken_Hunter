<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>簡単横スクロールゲーム</title>
<style>
  body { margin: 0; overflow: hidden; background: skyblue; }
  canvas { display: block; margin: auto; background: #70c5ce; }
</style>
</head>
<body>
<canvas id="game" width="800" height="400"></canvas>

<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>横スクロールゲーム</title>
<style>
  body { margin: 0; overflow: hidden; background: skyblue; }
  canvas { display: block; margin: auto; background: #70c5ce; }
</style>
</head>
<body>
<canvas id="game" width="800" height="400"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// プレイヤー設定
let player = { x: 50, y: 300, w: 64, h: 64, vy: 0, jump: false };

// プレイヤー画像
const playerImg = new Image();
playerImg.src = "player.png"; // 同じフォルダに置く

// 敵画像
const enemyImgs = [new Image(), new Image(), new Image()];
enemyImgs[0].src = "enemy1.png";
enemyImgs[1].src = "enemy2.png";
enemyImgs[2].src = "enemy3.png";

// 敵配列
let enemies = [];
let frame = 0;
let score = 0;
let hitCount = 0;  // 当たった回数

// 入力（スペースキー）
document.addEventListener("keydown", e => {
  if (e.code === "Space" && !player.jump) {
    player.vy = -40;  // ジャンプ力2倍
    player.jump = true;
  }
});

// 入力（タッチ）
canvas.addEventListener("touchstart", e => {
  e.preventDefault();
  if (!player.jump) {
    player.vy = -40;  // ジャンプ力2倍
    player.jump = true;
  }
});

// 衝突判定
function checkHit(a, b) {
  return (
    a.x < b.x + b.w &&
    a.x + a.w > b.x &&
    a.y < b.y + b.h &&
    a.y + a.h > b.y
  );
}

// ゲームオーバー
function gameOver() {
  alert("ゲームオーバー！スコア: " + score + "\n当たり回数: " + hitCount);
  document.location.reload();
}

// 更新処理
function update() {
  frame++;

  // ジャンプと重力
  player.vy += 0.5;   // 重力
  player.y += player.vy;
  if (player.y > 300) {
    player.y = 300;
    player.jump = false;
  }

  // 敵生成（出現回数半分）
  if (frame % 300 === 0) {
    const imgIndex = Math.floor(Math.random() * enemyImgs.length);
    enemies.push({
      x: 800,
      y: 270,
      w: 64,
      h: 64,
      dir: Math.random() < 0.5 ? 1 : -1,
      img: enemyImgs[imgIndex]
    });
  }

  // 敵移動
  for (let e of enemies) {
    e.x -= 1.5;
    e.y += e.dir * 2;
    if (e.y < 250 || e.y > 300) e.dir *= -1;
  }
  enemies = enemies.filter(e => e.x + e.w > 0);

  // 衝突判定（敵）
  for (let e of enemies) {
    if (checkHit(player, e)) {
      hitCount++;
      e.x = -100;  // 当たった敵を消す
    }
  }

  // 5回当たったらゲームオーバー
  if (hitCount >= 5) gameOver();

  score++;
}

// 描画処理
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // 地面
  ctx.fillStyle = "green";
  ctx.fillRect(0, 360, 800, 40);

  // プレイヤー（画像）
  ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);

  // 敵（画像）
  for (let e of enemies) ctx.drawImage(e.img, e.x, e.y, e.w, e.h);

  // スコアとヒットカウント
  ctx.fillStyle = "white";
  ctx.font = "20px sans-serif";
  ctx.fillText("Score: " + score, 20, 30);
  ctx.fillText("Hit: " + hitCount + " / 5", 20, 60);
}

// ゲームループ
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
</body>
</html>
</body>
</html>

</body>
</html>
